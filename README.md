# Obsidian Git Sync

一个用于 Obsidian 的 Git 同步插件，支持自动同步和手动同步，专为桌面端设计。

## ✨ 功能特性

- 🔄 **自动定时同步** - 可配置间隔的自动同步
- 📥 **手动同步** - 支持手动执行同步、拉取、推送操作
- 📊 **状态栏显示** - 实时显示同步状态（就绪、同步中、错误、冲突）
- ⚠️ **冲突检测** - 自动检测并提醒 Git 冲突
- 🚀 **启动时拉取** - Obsidian 启动时自动拉取远程更新
- 📝 **提交模板** - 支持 `{{date}}`、`{{time}}` 变量的提交消息模板

## 📦 安装

1. 下载 `main.js`、`manifest.json`、`styles.css`
2. 复制到 `<你的库>/.obsidian/plugins/obsidian-git-sync/`
3. 在 Obsidian 设置中启用插件

## ⚠️ 前置条件

- 系统已安装 Git
- 库已初始化为 Git 仓库 (`git init`)
- 已配置远程仓库 (`git remote add origin <url>`)
- 已配置 Git 凭证（用户名、邮箱、认证信息）

## 🎯 命令

| 命令 | 功能 |
|------|------|
| 同步 | 拉取 → 提交 → 推送 |
| 拉取 | 仅拉取远程更新 |
| 推送 | 提交并推送到远程 |
| 状态 | 显示当前仓库状态 |
| 初始化 | 初始化 Git 仓库 |

## ⚙️ 设置

| 选项 | 说明 | 默认值 |
|------|------|--------|
| 自动同步 | 启用/禁用定时同步 | 否 |
| 同步间隔 | 同步时间间隔（分钟） | 30 |
| 提交消息 | 提交消息模板，支持 `{{date}}`、`{{time}}` | `同步：{{date}} {{time}}` |
| 启动时拉取 | Obsidian 启动时自动拉取 | 是 |

## 🛠️ 开发

```bash
npm install    # 安装依赖
npm run dev    # 开发模式（监听文件变化）
npm run build  # 构建生产版本
```

## 📁 项目结构

```
obsidian-git-sync/
├── src/
│   ├── git/         # Git 命令执行封装
│   ├── sync/        # 同步逻辑协调
│   └── ui/          # 设置面板和状态栏 UI
├── main.ts          # 插件入口
├── manifest.json    # 插件配置
├── styles.css       # 样式文件
└── README.md        # 项目文档
```

## 📝 说明

- 本插件仅支持桌面端（使用 `child_process` 执行 Git 命令）
- 同步操作带有互斥锁，防止并发执行
- 自动同步会在 Obsidian 后台持续运行，插件卸载时自动清理